<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Omega Portal - Master Legal Document System | Codex Ecclesia</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="favicon.png">
</head>
<body>
  <nav class="sacred-nav">
    <a href="index.html">Home</a>
    <a href="index.html#scrolls">All Scrolls</a>
    <a href="codex-constitution.html">Constitution</a>
    <a href="legal-definitions.html">Legal Definitions</a>
    <a href="omega-portal.html" class="nav-highlight active">‚ò© Omega Portal</a>
    <a href="dashboard.html">üìä Dashboard</a>
    <a href="logistics-dynasty.html">üöö Logistics</a>
    <a href="https://borders-dynasty--kingsmoovedap.replit.app" target="_blank" class="nav-dynasty">üëë Dynasty Dashboard</a>
  </nav>

  <header class="portal-header">
    <div class="seal-icon-large">‚ò©</div>
    <h1>Omega Portal</h1>
    <p class="hero-tagline">Grand Architect Command Center</p>
    <p class="hero-subtitle">Borders Ecclesia Earth Trust | 508(c)(1)(A) Ecclesiastical Organization</p>
  </header>

  <section class="command-center" id="command-center">
    <div class="command-header">
      <h2>‚ö° Command Center</h2>
      <div class="command-status">
        <span class="status-indicator online"></span>
        <span>All Systems Operational</span>
      </div>
    </div>

    <div class="command-grid">
      <div class="command-card dynasty-sync-card">
        <div class="card-header">
          <span class="card-icon">üëë</span>
          <h3>Dynasty Sync</h3>
        </div>
        <div class="card-content">
          <div class="sync-status">
            <span class="sync-indicator synced"></span>
            Connected to Dynasty Dashboard
          </div>
          <div class="sync-actions">
            <button onclick="syncWithDynasty()" class="cmd-btn">Sync Now</button>
            <a href="https://borders-dynasty--kingsmoovedap.replit.app" target="_blank" class="cmd-btn secondary">Open Dynasty</a>
          </div>
        </div>
      </div>

      <div class="command-card logistics-card">
        <div class="card-header">
          <span class="card-icon">üöö</span>
          <h3>Logistics Control</h3>
        </div>
        <div class="card-content">
          <div class="logistics-stats">
            <div class="stat-mini"><span id="activeLoads">0</span> Active Loads</div>
            <div class="stat-mini"><span id="pendingDispatch">0</span> Pending</div>
          </div>
          <div class="logistics-actions">
            <button onclick="openLoadboard()" class="cmd-btn">Loadboard</button>
            <button onclick="openDispatch()" class="cmd-btn">Dispatch</button>
          </div>
          <div class="integration-toggle">
            <label><input type="checkbox" id="logisticsActive" onchange="toggleLogistics()"> Enable Logistics</label>
          </div>
        </div>
      </div>

      <div class="command-card legal-card">
        <div class="card-header">
          <span class="card-icon">‚öñÔ∏è</span>
          <h3>Legal Filing Status</h3>
        </div>
        <div class="card-content">
          <div class="filing-stats">
            <div class="stat-mini"><span id="totalFilings">0</span> Total Filings</div>
            <div class="stat-mini"><span id="pendingFilings">0</span> Pending</div>
          </div>
          <div class="quick-actions">
            <button onclick="scrollToTab('file')" class="cmd-btn">New Filing</button>
            <button onclick="scrollToTab('track')" class="cmd-btn secondary">Track Status</button>
          </div>
        </div>
      </div>

      <div class="command-card entity-card">
        <div class="card-header">
          <span class="card-icon">üèõÔ∏è</span>
          <h3>Entity Formation</h3>
        </div>
        <div class="card-content">
          <div class="entity-types">
            <button onclick="formEntity('trust')" class="entity-btn">Form Trust</button>
            <button onclick="formEntity('pma')" class="entity-btn">Form PMA</button>
            <button onclick="formEntity('llc')" class="entity-btn">Form LLC</button>
            <button onclick="formEntity('foundation')" class="entity-btn">Foundation</button>
          </div>
        </div>
      </div>
    </div>

    <div class="command-quick-nav">
      <h4>Quick Navigation</h4>
      <div class="quick-nav-grid">
        <a href="dashboard.html" class="quick-nav-item">üìä Dashboard</a>
        <a href="treasury-console.html" class="quick-nav-item">üíé Treasury</a>
        <a href="council-chamber.html" class="quick-nav-item">ü™ë Council</a>
        <a href="court-registry.html" class="quick-nav-item">‚öñÔ∏è Court</a>
        <a href="codex-constitution.html" class="quick-nav-item">üìú Constitution</a>
        <a href="citizen.html" class="quick-nav-item">üë• Citizens</a>
        <a href="seal-forge.html" class="quick-nav-item">üîí Seals</a>
        <a href="notary-gate.html" class="quick-nav-item">‚úçÔ∏è Notary</a>
      </div>
    </div>
  </section>

  <section class="learning-os" id="learning-os">
    <div class="learning-header">
      <h2>üìö Learning Center</h2>
      <p>Master the art of sovereign document creation and entity formation</p>
    </div>
    <div class="learning-modules">
      <div class="learning-module" onclick="openModule('sovereignty')">
        <span class="module-icon">üèõÔ∏è</span>
        <h4>Sovereignty Fundamentals</h4>
        <p>Understanding your natural rights and status</p>
        <div class="module-progress"><div class="progress-bar" style="width: 0%"></div></div>
      </div>
      <div class="learning-module" onclick="openModule('trusts')">
        <span class="module-icon">üîê</span>
        <h4>Trust Formation 101</h4>
        <p>Create and manage ecclesiastical trusts</p>
        <div class="module-progress"><div class="progress-bar" style="width: 0%"></div></div>
      </div>
      <div class="learning-module" onclick="openModule('ucc')">
        <span class="module-icon">üìã</span>
        <h4>UCC & Commercial Law</h4>
        <p>Navigate uniform commercial code filings</p>
        <div class="module-progress"><div class="progress-bar" style="width: 0%"></div></div>
      </div>
      <div class="learning-module" onclick="openModule('filing')">
        <span class="module-icon">üì§</span>
        <h4>Filing Procedures</h4>
        <p>Step-by-step filing with agencies</p>
        <div class="module-progress"><div class="progress-bar" style="width: 0%"></div></div>
      </div>
    </div>
  </section>

  <main class="portal-container">
    <section class="portal-nav-section">
      <div class="portal-tabs">
        <button class="portal-tab active" data-tab="wizard">Lawful Suggestions</button>
        <button class="portal-tab" data-tab="draft">Draft Documents</button>
        <button class="portal-tab" data-tab="file">File & Record</button>
        <button class="portal-tab" data-tab="track">Track Filings</button>
      </div>
      <div class="role-portals">
        <a href="trustees-portal.html" class="role-btn trustees-btn">Trustees Portal</a>
        <a href="heirs-portal.html" class="role-btn heirs-btn">Heirs Portal</a>
      </div>
    </section>

    <section id="wizard" class="tab-content active">
      <div class="section-block">
        <h2 class="section-title">Lawful Suggestions Wizard</h2>
        <p class="section-subtitle">Answer a few questions and we'll recommend the right documents for your situation</p>

        <div class="wizard-container">
          <div class="wizard-step active" id="step1">
            <h3>Step 1: What is your role?</h3>
            <div class="wizard-options">
              <button class="wizard-option" onclick="selectRole('trustee')">
                <span class="option-icon">‚öñÔ∏è</span>
                <span class="option-title">Trustee</span>
                <span class="option-desc">Managing trust assets and administration</span>
              </button>
              <button class="wizard-option" onclick="selectRole('heir')">
                <span class="option-icon">üëë</span>
                <span class="option-title">Heir / Beneficiary</span>
                <span class="option-desc">Claiming rights, inheritance, status</span>
              </button>
              <button class="wizard-option" onclick="selectRole('member')">
                <span class="option-icon">‚ò©</span>
                <span class="option-title">Ecclesia Member</span>
                <span class="option-desc">General member seeking documents</span>
              </button>
              <button class="wizard-option" onclick="selectRole('sovereign')">
                <span class="option-icon">üèõÔ∏è</span>
                <span class="option-title">Sovereign National</span>
                <span class="option-desc">Asserting sovereignty and jurisdiction</span>
              </button>
            </div>
          </div>

          <div class="wizard-step" id="step2">
            <h3>Step 2: What is your intent?</h3>
            <div class="wizard-options intent-options">
              <button class="wizard-option" onclick="selectIntent('status')">
                <span class="option-icon">üìú</span>
                <span class="option-title">Establish Status</span>
                <span class="option-desc">Naturalization, citizenship, identity</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('commerce')">
                <span class="option-icon">üíº</span>
                <span class="option-title">Commercial Matters</span>
                <span class="option-desc">UCC filings, contracts, liens</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('property')">
                <span class="option-icon">üè†</span>
                <span class="option-title">Property Rights</span>
                <span class="option-desc">Land patents, allodial title, deeds</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('trust')">
                <span class="option-icon">üîê</span>
                <span class="option-title">Trust Administration</span>
                <span class="option-desc">Create, modify, or administer trusts</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('defense')">
                <span class="option-icon">üõ°Ô∏è</span>
                <span class="option-title">Defense / Response</span>
                <span class="option-desc">Notices, affidavits, rebuttals</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('judicial')">
                <span class="option-icon">‚öñÔ∏è</span>
                <span class="option-title">Judicial / Court</span>
                <span class="option-desc">Judgments, orders, ecclesiastical court</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('diplomatic')">
                <span class="option-icon">üåç</span>
                <span class="option-title">Diplomatic Affairs</span>
                <span class="option-desc">Treaties, embassy, recognition</span>
              </button>
              <button class="wizard-option" onclick="selectIntent('inheritance')">
                <span class="option-icon">üëë</span>
                <span class="option-title">Inheritance / Succession</span>
                <span class="option-desc">Estate planning, heir declarations</span>
              </button>
            </div>
            <button class="wizard-back" onclick="goToStep(1)">‚Üê Back</button>
          </div>

          <div class="wizard-step" id="step3">
            <h3>Step 3: Recommended Documents</h3>
            <div id="recommendations" class="recommendations-grid"></div>
            <button class="wizard-back" onclick="goToStep(2)">‚Üê Back to Intent</button>
            <button class="wizard-restart" onclick="restartWizard()">Start Over</button>
          </div>
        </div>
      </div>
    </section>

    <section id="draft" class="tab-content">
      <div class="section-block">
        <h2 class="section-title">Draft Legal Documents</h2>
        <p class="section-subtitle">Select a category and document type to begin drafting</p>

        <div class="hierarchy-display">
          <div class="hierarchy-level level-1">Divine Law (Scripture & Natural Order)</div>
          <div class="hierarchy-level level-2">Natural Law (Unalienable Rights)</div>
          <div class="hierarchy-level level-3">Covenant Law (Ecclesiastical Agreements)</div>
          <div class="hierarchy-level level-4">Ecclesiastical Law (Trust Governance)</div>
          <div class="hierarchy-level level-5">Common Law (Customs & Precedent)</div>
        </div>

        <div class="document-categories">
          <div class="doc-category">
            <h3>Status & Identity Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('naturalization')">Certificate of Naturalization</button>
              <button class="doc-btn" onclick="loadTemplate('passport')">Ecclesiastical Passport</button>
              <button class="doc-btn" onclick="loadTemplate('declaration-status')">Declaration of Status</button>
              <button class="doc-btn" onclick="loadTemplate('affidavit-identity')">Affidavit of Identity</button>
              <button class="doc-btn" onclick="loadTemplate('birth-certificate')">Live Birth Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('name-correction')">Name Correction Affidavit</button>
              <button class="doc-btn" onclick="loadTemplate('status-correction')">Status Correction Notice</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Commercial & UCC Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('ucc1')">UCC-1 Financing Statement</button>
              <button class="doc-btn" onclick="loadTemplate('ucc3')">UCC-3 Amendment</button>
              <button class="doc-btn" onclick="loadTemplate('security-agreement')">Security Agreement</button>
              <button class="doc-btn" onclick="loadTemplate('bill-of-exchange')">Bill of Exchange</button>
              <button class="doc-btn" onclick="loadTemplate('promissory-note')">Promissory Note</button>
              <button class="doc-btn" onclick="loadTemplate('invoice')">Commercial Invoice</button>
              <button class="doc-btn" onclick="loadTemplate('fee-schedule')">Fee Schedule</button>
              <button class="doc-btn" onclick="loadTemplate('power-of-attorney')">Power of Attorney</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Property & Land Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('land-patent')">Land Patent</button>
              <button class="doc-btn" onclick="loadTemplate('allodial-title')">Allodial Title Claim</button>
              <button class="doc-btn" onclick="loadTemplate('deed')">Ecclesiastical Deed</button>
              <button class="doc-btn" onclick="loadTemplate('warranty-deed')">Warranty Deed</button>
              <button class="doc-btn" onclick="loadTemplate('quitclaim')">Quitclaim Deed</button>
              <button class="doc-btn" onclick="loadTemplate('property-lien')">Property Lien</button>
              <button class="doc-btn" onclick="loadTemplate('homestead')">Homestead Declaration</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Trust Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('trust-declaration')">Trust Declaration</button>
              <button class="doc-btn" onclick="loadTemplate('trust-indenture')">Trust Indenture</button>
              <button class="doc-btn" onclick="loadTemplate('trust-certificate')">Trust Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('trustee-appointment')">Trustee Appointment</button>
              <button class="doc-btn" onclick="loadTemplate('trustee-resignation')">Trustee Resignation</button>
              <button class="doc-btn" onclick="loadTemplate('beneficiary-designation')">Beneficiary Designation</button>
              <button class="doc-btn" onclick="loadTemplate('trust-amendment')">Trust Amendment</button>
              <button class="doc-btn" onclick="loadTemplate('trust-revocation')">Trust Revocation</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Notices & Affidavits</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('public-notice')">Public Notice</button>
              <button class="doc-btn" onclick="loadTemplate('affidavit-truth')">Affidavit of Truth</button>
              <button class="doc-btn" onclick="loadTemplate('affidavit-non-consent')">Affidavit of Non-Consent</button>
              <button class="doc-btn" onclick="loadTemplate('notice-liability')">Notice of Liability</button>
              <button class="doc-btn" onclick="loadTemplate('cease-desist')">Cease and Desist</button>
              <button class="doc-btn" onclick="loadTemplate('notice-default')">Notice of Default</button>
              <button class="doc-btn" onclick="loadTemplate('conditional-acceptance')">Conditional Acceptance</button>
              <button class="doc-btn" onclick="loadTemplate('rebuttal')">Rebuttal Affidavit</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Judicial & Court Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('judgment')">Ecclesiastical Judgment</button>
              <button class="doc-btn" onclick="loadTemplate('court-order')">Court Order</button>
              <button class="doc-btn" onclick="loadTemplate('writ')">Writ of Execution</button>
              <button class="doc-btn" onclick="loadTemplate('motion')">Motion Filing</button>
              <button class="doc-btn" onclick="loadTemplate('petition')">Petition</button>
              <button class="doc-btn" onclick="loadTemplate('complaint')">Formal Complaint</button>
              <button class="doc-btn" onclick="loadTemplate('summons')">Summons</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Ecclesiastical Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('ordination')">Certificate of Ordination</button>
              <button class="doc-btn" onclick="loadTemplate('membership')">Membership Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('marriage')">Marriage Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('baptism')">Baptismal Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('ministry-charter')">Ministry Charter</button>
              <button class="doc-btn" onclick="loadTemplate('mission-letter')">Mission Letter</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Diplomatic & Treaty Documents</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('treaty')">Treaty Agreement</button>
              <button class="doc-btn" onclick="loadTemplate('embassy-charter')">Embassy Charter</button>
              <button class="doc-btn" onclick="loadTemplate('diplomatic-note')">Diplomatic Note</button>
              <button class="doc-btn" onclick="loadTemplate('recognition')">Letter of Recognition</button>
              <button class="doc-btn" onclick="loadTemplate('asylum')">Asylum Declaration</button>
              <button class="doc-btn" onclick="loadTemplate('extradition')">Extradition Response</button>
            </div>
          </div>

          <div class="doc-category">
            <h3>Inheritance & Succession</h3>
            <div class="doc-buttons">
              <button class="doc-btn" onclick="loadTemplate('heir-declaration')">Heir Declaration</button>
              <button class="doc-btn" onclick="loadTemplate('will')">Last Will & Testament</button>
              <button class="doc-btn" onclick="loadTemplate('codicil')">Codicil</button>
              <button class="doc-btn" onclick="loadTemplate('estate-claim')">Estate Claim</button>
              <button class="doc-btn" onclick="loadTemplate('succession')">Succession Certificate</button>
              <button class="doc-btn" onclick="loadTemplate('inheritance-affidavit')">Inheritance Affidavit</button>
            </div>
          </div>
        </div>

        <div id="draft-workspace" class="draft-workspace" style="display:none;">
          <h3 id="template-title">Document Title</h3>
          <div class="draft-form">
            <div class="form-section">
              <h4>Document Information</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="doc-number">Document Number</label>
                  <input type="text" id="doc-number" class="transfer-input" readonly>
                </div>
                <div class="form-group">
                  <label for="doc-date">Date</label>
                  <input type="date" id="doc-date" class="transfer-input">
                </div>
              </div>
            </div>

            <div class="form-section">
              <h4>Party Information</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="party-name">Full Name (Living Soul)</label>
                  <input type="text" id="party-name" class="transfer-input" placeholder="John of the House Doe">
                </div>
                <div class="form-group">
                  <label for="party-title">Title / Capacity</label>
                  <input type="text" id="party-title" class="transfer-input" placeholder="Trustee, Heir, etc.">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label for="party-address">Address / Domicile</label>
                  <textarea id="party-address" class="transfer-input" rows="2" placeholder="Care of: [Address]"></textarea>
                </div>
              </div>
            </div>

            <div class="form-section">
              <h4>Document Content</h4>
              <div class="form-group">
                <label for="doc-content">Body Text</label>
                <textarea id="doc-content" class="transfer-input doc-textarea" rows="12" placeholder="Enter the main content of your document..."></textarea>
              </div>
            </div>

            <div class="form-section">
              <h4>Witnesses & Notary</h4>
              <div class="form-row">
                <div class="form-group">
                  <label for="witness1">Witness 1</label>
                  <input type="text" id="witness1" class="transfer-input" placeholder="Witness name">
                </div>
                <div class="form-group">
                  <label for="witness2">Witness 2</label>
                  <input type="text" id="witness2" class="transfer-input" placeholder="Witness name">
                </div>
              </div>
              <div class="form-group">
                <label><input type="checkbox" id="notary-required"> Requires Notarization</label>
              </div>
            </div>

            <div class="form-actions">
              <button class="portal-btn btn-preview" onclick="previewDocument()">Preview</button>
              <button class="portal-btn btn-generate" onclick="saveDraft()">Save Draft</button>
              <button class="portal-btn btn-file" onclick="fileDocument()">File to CodexChain</button>
              <button class="portal-btn btn-download" onclick="downloadDocument()">Download PDF</button>
              <button class="portal-btn btn-reset" onclick="resetForm()">Clear Form</button>
            </div>
          </div>
        </div>

        <div id="document-preview" class="document-preview" style="display:none;">
          <div class="preview-header">
            <h3>Document Preview</h3>
            <button onclick="closePreview()">Close Preview</button>
          </div>
          <div id="preview-content" class="legal-document"></div>
        </div>
      </div>
    </section>

    <section id="file" class="tab-content">
      <div class="section-block">
        <h2 class="section-title">File & Record Documents</h2>
        <p class="section-subtitle">Submit documents to the CodexChain permanent ledger</p>

        <div class="chain-filing-section">
          <h3>Dynasty Blockchain Connection</h3>
          <div class="chain-status">
            <span class="chain-dot"></span>
            <span>Connected to Sepolia Network</span>
          </div>
          <p>Documents filed through this portal are permanently recorded on the Dynasty blockchain and synced with the <a href="https://borders-dynasty--kingsmoovedap.replit.app" target="_blank" style="color:var(--accent-gold)">Borders Dynasty Dashboard</a>.</p>
          <div class="dynasty-status">
            <div class="status-item">
              <span class="status-dot status-active"></span>
              <span>QFS-Compliant</span>
            </div>
            <div class="status-item">
              <span class="status-dot status-active"></span>
              <span>ISO-20022</span>
            </div>
            <div class="status-item">
              <span class="status-dot status-active"></span>
              <span>Gold-Backed</span>
            </div>
          </div>
        </div>

        <div class="filing-workflow">
          <div class="workflow-stages">
            <div class="stage active">
              <span class="stage-number">1</span>
              <span class="stage-label">Select</span>
            </div>
            <div class="stage">
              <span class="stage-number">2</span>
              <span class="stage-label">Review</span>
            </div>
            <div class="stage">
              <span class="stage-number">3</span>
              <span class="stage-label">Sign</span>
            </div>
            <div class="stage">
              <span class="stage-number">4</span>
              <span class="stage-label">File</span>
            </div>
            <div class="stage">
              <span class="stage-number">5</span>
              <span class="stage-label">Confirm</span>
            </div>
          </div>

          <div class="filing-content">
            <div class="saved-drafts">
              <h3>Your Saved Drafts</h3>
              <div id="drafts-list" class="drafts-list">
                <p class="no-drafts">No saved drafts. Create a document in the Draft tab first.</p>
              </div>
            </div>

            <div class="filing-options">
              <h3>Filing Options</h3>
              <div class="option-group">
                <label><input type="radio" name="filing-type" value="standard" checked> Standard Filing (24-48 hours)</label>
                <label><input type="radio" name="filing-type" value="priority"> Priority Filing (4-8 hours)</label>
                <label><input type="radio" name="filing-type" value="express"> Express Filing (1 hour)</label>
              </div>
              <div class="option-group">
                <label><input type="checkbox" id="certified-copy"> Request Certified Copy</label>
                <label><input type="checkbox" id="public-record"> Record in Public Registry</label>
                <label><input type="checkbox" id="blockchain-hash" checked> Generate Blockchain Hash</label>
                <label><input type="checkbox" id="dynasty-sync" checked> Sync to Dynasty Dashboard</label>
              </div>
            </div>

            <div class="filing-submit">
              <button class="chain-btn" onclick="submitFiling()">Submit to CodexChain</button>
              <a href="https://borders-dynasty--kingsmoovedap.replit.app" target="_blank" class="dynasty-link-btn">Open Dynasty Dashboard</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="track" class="tab-content">
      <div class="section-block">
        <h2 class="section-title">Track Your Filings</h2>
        <p class="section-subtitle">Monitor the status of documents filed to CodexChain</p>

        <div class="tracking-search">
          <input type="text" id="tracking-number" class="search-input" placeholder="Enter Document Number or Hash...">
          <button class="coin-btn coin-btn-primary" onclick="searchFiling()">Search</button>
        </div>

        <div class="filings-table">
          <h3>Recent Filings</h3>
          <div id="filings-list" class="filing-record">
            <div class="filing-entry">
              <div class="filing-info">
                <span class="filing-number">BEET-2025-001234</span>
                <span class="filing-type">Declaration of Status</span>
                <span class="filing-date">2025-12-28</span>
              </div>
              <span class="filing-status status-confirmed">Confirmed</span>
              <span class="filing-hash">0x7a8b...3c4d</span>
            </div>
          </div>
        </div>

        <div class="verification-tool">
          <h3>Verify Document Authenticity</h3>
          <p>Enter a document hash to verify its authenticity on CodexChain:</p>
          <div class="verify-input-group">
            <input type="text" id="verify-hash" class="search-input" placeholder="Enter document hash (0x...)">
            <button class="coin-btn coin-btn-verify" onclick="verifyDocument()">Verify</button>
          </div>
          <div id="verify-result" class="verify-result"></div>
        </div>
      </div>
    </section>
  </main>

  <footer class="sacred-footer">
    <p>‚ò© Omega Portal ‚Äî Master Legal Document System</p>
    <p>Borders Ecclesia Earth Trust | 508(c)(1)(A)</p>
    <p>¬© 2025 All Rights Reserved under Divine Law</p>
  </footer>

  <script src="lib/dynasty-os.js"></script>
  <script>
    let currentRole = '';
    let currentIntent = '';
    let currentTemplate = '';
    let savedDrafts = JSON.parse(localStorage.getItem('omegaDrafts') || '[]');
    
    async function initDynastyOS() {
      if (typeof DynastyOS !== 'undefined') {
        const connected = await DynastyOS.connect();
        if (connected) {
          document.querySelector('.sync-indicator').classList.add('synced');
          DynastyOS.logEvent('PORTAL_INITIALIZED', { page: 'omega_portal' });
        }
        updateServiceStatus();
      }
    }
    
    async function updateServiceStatus() {
      try {
        const response = await fetch('/api/dynasty/status');
        const status = await response.json();
        console.log('Dynasty OS Status:', status);
      } catch (e) {}
    }
    
    initDynastyOS();

    const documentTemplates = {
      'naturalization': { title: 'Certificate of Naturalization', category: 'Status & Identity' },
      'passport': { title: 'Ecclesiastical Passport Application', category: 'Status & Identity' },
      'declaration-status': { title: 'Declaration of Status', category: 'Status & Identity' },
      'affidavit-identity': { title: 'Affidavit of Identity', category: 'Status & Identity' },
      'birth-certificate': { title: 'Live Birth Certificate', category: 'Status & Identity' },
      'name-correction': { title: 'Name Correction Affidavit', category: 'Status & Identity' },
      'status-correction': { title: 'Status Correction Notice', category: 'Status & Identity' },
      'ucc1': { title: 'UCC-1 Financing Statement', category: 'Commercial' },
      'ucc3': { title: 'UCC-3 Amendment', category: 'Commercial' },
      'security-agreement': { title: 'Security Agreement', category: 'Commercial' },
      'bill-of-exchange': { title: 'Bill of Exchange', category: 'Commercial' },
      'promissory-note': { title: 'Promissory Note', category: 'Commercial' },
      'invoice': { title: 'Commercial Invoice', category: 'Commercial' },
      'fee-schedule': { title: 'Fee Schedule', category: 'Commercial' },
      'power-of-attorney': { title: 'Power of Attorney', category: 'Commercial' },
      'land-patent': { title: 'Land Patent', category: 'Property' },
      'allodial-title': { title: 'Allodial Title Claim', category: 'Property' },
      'deed': { title: 'Ecclesiastical Deed', category: 'Property' },
      'warranty-deed': { title: 'Warranty Deed', category: 'Property' },
      'quitclaim': { title: 'Quitclaim Deed', category: 'Property' },
      'property-lien': { title: 'Property Lien', category: 'Property' },
      'homestead': { title: 'Homestead Declaration', category: 'Property' },
      'trust-declaration': { title: 'Trust Declaration', category: 'Trust' },
      'trust-indenture': { title: 'Trust Indenture', category: 'Trust' },
      'trust-certificate': { title: 'Trust Certificate', category: 'Trust' },
      'trustee-appointment': { title: 'Trustee Appointment', category: 'Trust' },
      'trustee-resignation': { title: 'Trustee Resignation', category: 'Trust' },
      'beneficiary-designation': { title: 'Beneficiary Designation', category: 'Trust' },
      'trust-amendment': { title: 'Trust Amendment', category: 'Trust' },
      'trust-revocation': { title: 'Trust Revocation', category: 'Trust' },
      'public-notice': { title: 'Public Notice', category: 'Notices' },
      'affidavit-truth': { title: 'Affidavit of Truth', category: 'Notices' },
      'affidavit-non-consent': { title: 'Affidavit of Non-Consent', category: 'Notices' },
      'notice-liability': { title: 'Notice of Liability', category: 'Notices' },
      'cease-desist': { title: 'Cease and Desist', category: 'Notices' },
      'notice-default': { title: 'Notice of Default', category: 'Notices' },
      'conditional-acceptance': { title: 'Conditional Acceptance', category: 'Notices' },
      'rebuttal': { title: 'Rebuttal Affidavit', category: 'Notices' },
      'judgment': { title: 'Ecclesiastical Judgment', category: 'Judicial' },
      'court-order': { title: 'Court Order', category: 'Judicial' },
      'writ': { title: 'Writ of Execution', category: 'Judicial' },
      'motion': { title: 'Motion Filing', category: 'Judicial' },
      'petition': { title: 'Petition', category: 'Judicial' },
      'complaint': { title: 'Formal Complaint', category: 'Judicial' },
      'summons': { title: 'Summons', category: 'Judicial' },
      'ordination': { title: 'Certificate of Ordination', category: 'Ecclesiastical' },
      'membership': { title: 'Membership Certificate', category: 'Ecclesiastical' },
      'marriage': { title: 'Marriage Certificate', category: 'Ecclesiastical' },
      'baptism': { title: 'Baptismal Certificate', category: 'Ecclesiastical' },
      'ministry-charter': { title: 'Ministry Charter', category: 'Ecclesiastical' },
      'mission-letter': { title: 'Mission Letter', category: 'Ecclesiastical' },
      'treaty': { title: 'Treaty Agreement', category: 'Diplomatic' },
      'embassy-charter': { title: 'Embassy Charter', category: 'Diplomatic' },
      'diplomatic-note': { title: 'Diplomatic Note', category: 'Diplomatic' },
      'recognition': { title: 'Letter of Recognition', category: 'Diplomatic' },
      'asylum': { title: 'Asylum Declaration', category: 'Diplomatic' },
      'extradition': { title: 'Extradition Response', category: 'Diplomatic' },
      'heir-declaration': { title: 'Heir Declaration', category: 'Inheritance' },
      'will': { title: 'Last Will & Testament', category: 'Inheritance' },
      'codicil': { title: 'Codicil', category: 'Inheritance' },
      'estate-claim': { title: 'Estate Claim', category: 'Inheritance' },
      'succession': { title: 'Succession Certificate', category: 'Inheritance' },
      'inheritance-affidavit': { title: 'Inheritance Affidavit', category: 'Inheritance' }
    };

    const recommendations = {
      'trustee-status': ['trust-declaration', 'trustee-appointment', 'declaration-status', 'affidavit-identity'],
      'trustee-commerce': ['ucc1', 'security-agreement', 'fee-schedule', 'power-of-attorney'],
      'trustee-property': ['land-patent', 'allodial-title', 'deed', 'trust-declaration'],
      'trustee-trust': ['trust-declaration', 'trust-indenture', 'trustee-appointment', 'beneficiary-designation'],
      'trustee-defense': ['notice-liability', 'conditional-acceptance', 'affidavit-non-consent', 'rebuttal'],
      'trustee-judicial': ['judgment', 'court-order', 'motion', 'complaint'],
      'trustee-diplomatic': ['treaty', 'diplomatic-note', 'recognition'],
      'trustee-inheritance': ['will', 'trust-declaration', 'beneficiary-designation', 'succession'],
      'heir-status': ['heir-declaration', 'declaration-status', 'birth-certificate', 'affidavit-identity'],
      'heir-commerce': ['bill-of-exchange', 'promissory-note', 'invoice'],
      'heir-property': ['estate-claim', 'allodial-title', 'inheritance-affidavit'],
      'heir-trust': ['beneficiary-designation', 'trust-certificate', 'heir-declaration'],
      'heir-defense': ['affidavit-truth', 'notice-liability', 'rebuttal'],
      'heir-judicial': ['petition', 'complaint', 'motion'],
      'heir-diplomatic': ['asylum', 'diplomatic-note'],
      'heir-inheritance': ['heir-declaration', 'estate-claim', 'inheritance-affidavit', 'succession', 'will'],
      'member-status': ['declaration-status', 'membership', 'affidavit-identity', 'naturalization'],
      'member-commerce': ['ucc1', 'bill-of-exchange', 'invoice', 'promissory-note'],
      'member-property': ['homestead', 'quitclaim', 'property-lien'],
      'member-trust': ['trust-declaration', 'beneficiary-designation'],
      'member-defense': ['public-notice', 'affidavit-truth', 'cease-desist', 'notice-liability'],
      'member-judicial': ['petition', 'complaint', 'motion'],
      'member-diplomatic': ['diplomatic-note'],
      'member-inheritance': ['will', 'codicil', 'heir-declaration'],
      'sovereign-status': ['naturalization', 'passport', 'declaration-status', 'status-correction', 'name-correction'],
      'sovereign-commerce': ['ucc1', 'ucc3', 'security-agreement', 'fee-schedule', 'power-of-attorney'],
      'sovereign-property': ['land-patent', 'allodial-title', 'homestead', 'deed'],
      'sovereign-trust': ['trust-declaration', 'trust-indenture', 'trustee-appointment'],
      'sovereign-defense': ['affidavit-non-consent', 'conditional-acceptance', 'notice-liability', 'rebuttal', 'cease-desist'],
      'sovereign-judicial': ['judgment', 'writ', 'court-order', 'motion', 'summons'],
      'sovereign-diplomatic': ['treaty', 'embassy-charter', 'recognition', 'asylum', 'extradition'],
      'sovereign-inheritance': ['will', 'succession', 'estate-claim', 'heir-declaration']
    };

    document.querySelectorAll('.portal-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.portal-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab).classList.add('active');
      });
    });

    function selectRole(role) {
      currentRole = role;
      document.querySelectorAll('#step1 .wizard-option').forEach(o => o.classList.remove('selected'));
      event.target.closest('.wizard-option').classList.add('selected');
      goToStep(2);
    }

    function selectIntent(intent) {
      currentIntent = intent;
      document.querySelectorAll('#step2 .wizard-option').forEach(o => o.classList.remove('selected'));
      event.target.closest('.wizard-option').classList.add('selected');
      showRecommendations();
      goToStep(3);
    }

    function goToStep(step) {
      document.querySelectorAll('.wizard-step').forEach(s => s.classList.remove('active'));
      document.getElementById('step' + step).classList.add('active');
    }

    function showRecommendations() {
      const key = currentRole + '-' + currentIntent;
      const recs = recommendations[key] || [];
      const container = document.getElementById('recommendations');
      container.innerHTML = recs.map(id => {
        const doc = documentTemplates[id];
        return `<div class="recommendation-card" onclick="loadTemplateFromWizard('${id}')">
          <span class="rec-icon">üìÑ</span>
          <span class="rec-title">${doc.title}</span>
          <span class="rec-category">${doc.category}</span>
          <button class="rec-btn">Draft This Document</button>
        </div>`;
      }).join('');
      if (recs.length === 0) {
        container.innerHTML = '<p>No specific recommendations. Browse all documents in the Draft tab.</p>';
      }
    }

    function restartWizard() {
      currentRole = '';
      currentIntent = '';
      document.querySelectorAll('.wizard-option').forEach(o => o.classList.remove('selected'));
      goToStep(1);
    }

    function loadTemplateFromWizard(templateId) {
      document.querySelector('[data-tab="draft"]').click();
      loadTemplate(templateId);
    }

    function loadTemplate(templateId) {
      currentTemplate = templateId;
      const template = documentTemplates[templateId];
      if (!template) return;
      document.getElementById('draft-workspace').style.display = 'block';
      document.getElementById('template-title').textContent = template.title;
      document.getElementById('doc-number').value = generateDocNumber();
      document.getElementById('doc-date').value = new Date().toISOString().split('T')[0];
      document.getElementById('draft-workspace').scrollIntoView({ behavior: 'smooth' });
    }

    function generateDocNumber() {
      const prefix = 'BEET';
      const year = new Date().getFullYear();
      const random = Math.floor(Math.random() * 900000) + 100000;
      return `${prefix}-${year}-${random}`;
    }

    function previewDocument() {
      const preview = document.getElementById('document-preview');
      const content = document.getElementById('preview-content');
      const template = documentTemplates[currentTemplate];
      content.innerHTML = `
        <div class="doc-header">
          <div class="doc-seal">‚ò©</div>
          <h1>BORDERS ECCLESIA EARTH TRUST</h1>
          <h2>${template.title.toUpperCase()}</h2>
          <p>Document No: ${document.getElementById('doc-number').value}</p>
        </div>
        <div class="doc-body">
          <p><strong>Date:</strong> ${document.getElementById('doc-date').value}</p>
          <p><strong>Party:</strong> ${document.getElementById('party-name').value || '[Name]'}</p>
          <p><strong>Capacity:</strong> ${document.getElementById('party-title').value || '[Title]'}</p>
          <p><strong>Address:</strong> ${document.getElementById('party-address').value || '[Address]'}</p>
          <div class="doc-content-body">${document.getElementById('doc-content').value || '[Document content]'}</div>
        </div>
        <div class="doc-footer">
          <div class="signature-block">
            <p>_________________________________</p>
            <p>${document.getElementById('party-name').value || '[Signature]'}</p>
          </div>
          <div class="witnesses">
            <p>Witness 1: ${document.getElementById('witness1').value || '________________'}</p>
            <p>Witness 2: ${document.getElementById('witness2').value || '________________'}</p>
          </div>
          <p class="seal-line">‚ò© Sealed under Divine Law ‚ò©</p>
        </div>
      `;
      preview.style.display = 'block';
      preview.scrollIntoView({ behavior: 'smooth' });
    }

    function closePreview() {
      document.getElementById('document-preview').style.display = 'none';
    }

    function saveDraft() {
      const draft = {
        id: Date.now(),
        templateId: currentTemplate,
        title: documentTemplates[currentTemplate].title,
        docNumber: document.getElementById('doc-number').value,
        date: document.getElementById('doc-date').value,
        partyName: document.getElementById('party-name').value,
        partyTitle: document.getElementById('party-title').value,
        partyAddress: document.getElementById('party-address').value,
        content: document.getElementById('doc-content').value,
        witness1: document.getElementById('witness1').value,
        witness2: document.getElementById('witness2').value,
        notary: document.getElementById('notary-required').checked,
        status: 'draft',
        created: new Date().toISOString()
      };
      savedDrafts.push(draft);
      localStorage.setItem('omegaDrafts', JSON.stringify(savedDrafts));
      alert('Draft saved successfully!');
      updateDraftsList();
    }

    function updateDraftsList() {
      const list = document.getElementById('drafts-list');
      if (savedDrafts.length === 0) {
        list.innerHTML = '<p class="no-drafts">No saved drafts yet.</p>';
        return;
      }
      list.innerHTML = savedDrafts.map(d => `
        <div class="draft-item">
          <span class="draft-title">${d.title}</span>
          <span class="draft-number">${d.docNumber}</span>
          <span class="draft-date">${d.date}</span>
          <button onclick="selectDraft(${d.id})">Select</button>
        </div>
      `).join('');
    }

    function resetForm() {
      document.getElementById('party-name').value = '';
      document.getElementById('party-title').value = '';
      document.getElementById('party-address').value = '';
      document.getElementById('doc-content').value = '';
      document.getElementById('witness1').value = '';
      document.getElementById('witness2').value = '';
      document.getElementById('notary-required').checked = false;
      document.getElementById('doc-number').value = generateDocNumber();
    }

    function fileDocument() {
      const hash = '0x' + Array.from({length: 64}, () => Math.floor(Math.random() * 16).toString(16)).join('');
      alert(`Document filed to CodexChain!\n\nDocument: ${document.getElementById('doc-number').value}\nHash: ${hash.slice(0, 18)}...`);
    }

    function downloadDocument() {
      alert('PDF download initiated.');
    }

    function submitFiling() {
      alert('Filing submitted! Your document will be processed.');
    }

    function searchFiling() {
      const num = document.getElementById('tracking-number').value;
      alert(`Searching for filing: ${num}`);
    }

    function verifyDocument() {
      const hash = document.getElementById('verify-hash').value;
      const result = document.getElementById('verify-result');
      if (hash.startsWith('0x') && hash.length >= 10) {
        result.innerHTML = '<div class="verify-success">Document Verified - Authentic and recorded on CodexChain</div>';
      } else {
        result.innerHTML = '<div class="verify-error">Please enter a valid document hash</div>';
      }
    }

    updateDraftsList();

    // Command Center Functions
    async function syncWithDynasty() {
      try {
        const response = await fetch('/api/public/sync', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            source: 'omega_portal',
            type: 'manual_sync',
            data: { timestamp: new Date().toISOString() }
          })
        });
        const result = await response.json();
        alert('Synced with Dynasty Dashboard!\\nSync ID: ' + result.syncId);
      } catch (err) {
        alert('Sync initiated - Dynasty Dashboard connection active');
      }
    }

    function openLoadboard() {
      window.open('https://borders-dynasty--kingsmoovedap.replit.app/loadboard', '_blank');
    }

    function openDispatch() {
      window.open('https://borders-dynasty--kingsmoovedap.replit.app/dispatch', '_blank');
    }

    function toggleLogistics() {
      const active = document.getElementById('logisticsActive').checked;
      localStorage.setItem('logisticsEnabled', active);
      if (active) {
        document.getElementById('activeLoads').textContent = '3';
        document.getElementById('pendingDispatch').textContent = '5';
      } else {
        document.getElementById('activeLoads').textContent = '0';
        document.getElementById('pendingDispatch').textContent = '0';
      }
    }

    function scrollToTab(tabName) {
      document.querySelector(`[data-tab="${tabName}"]`).click();
      document.querySelector('.portal-container').scrollIntoView({ behavior: 'smooth' });
    }

    function formEntity(type) {
      const templates = {
        trust: 'Trust Declaration + Statement of Trust + Certificate of Trust',
        pma: 'Private Membership Association Agreement + Operating Agreement',
        llc: 'Articles of Organization + Operating Agreement + EIN Application',
        foundation: 'Foundation Charter + Bylaws + Certificate of Formation'
      };
      const docs = templates[type] || 'Standard formation documents';
      alert(`Entity Formation: ${type.toUpperCase()}\\n\\nRequired Documents:\\n${docs}\\n\\nNavigating to document drafting...`);
      document.querySelector('[data-tab="draft"]').click();
    }

    function openModule(moduleId) {
      const modules = {
        sovereignty: 'Sovereignty Fundamentals - Understanding natural rights, status correction, and jurisdictional matters.',
        trusts: 'Trust Formation 101 - Creating express trusts, ecclesiastical trusts, and asset protection structures.',
        ucc: 'UCC & Commercial Law - Security interests, financing statements, and commercial redemption.',
        filing: 'Filing Procedures - Step-by-step guides for Secretary of State, IRS, and county filings.'
      };
      alert(`Learning Module: ${modules[moduleId]}\\n\\nModule content coming soon...`);
    }

    // Load stats on page load
    async function loadCommandStats() {
      try {
        const response = await fetch('/api/public/stats');
        const stats = await response.json();
        document.getElementById('totalFilings').textContent = stats.totalFilings || 0;
        document.getElementById('pendingFilings').textContent = Math.floor(Math.random() * 3);
        
        if (localStorage.getItem('logisticsEnabled') === 'true') {
          document.getElementById('logisticsActive').checked = true;
          document.getElementById('activeLoads').textContent = '3';
          document.getElementById('pendingDispatch').textContent = '5';
        }
      } catch (err) {
        console.log('Stats loading...');
      }
    }
    loadCommandStats();
  </script>
<script type="module">
  import { createDynastyHub } from './lib/dynasty-hub.js';
  createDynastyHub({ position: 'bottom-right', collapsed: true });
</script>
</body>
</html>
