<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üìú Scroll Registry ‚Äì Codex Ecclesia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'EB Garamond', serif;
      background: #fdfaf6;
      color: #2c1a0f;
      padding: 2rem;
      max-width: 1000px;
      margin: auto;
    }
    h1 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 1rem;
      color: #5e3b1d;
    }
    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
      justify-content: center;
    }
    input, select {
      padding: 0.5rem;
      font-family: inherit;
      font-size: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .scroll-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }
    .scroll-card {
      background: #fff;
      border: 1px solid #d4af37;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    .scroll-card h3 {
      margin-top: 0;
      font-size: 1.2rem;
      color: #5e3b1d;
    }
    .scroll-card p {
      font-size: 0.95rem;
      color: #444;
    }
    .scroll-card a {
      display: inline-block;
      margin-top: 0.5rem;
      color: #003366;
      text-decoration: none;
      font-weight: bold;
    }
    .scroll-card a:hover {
      text-decoration: underline;
    }
    footer {
      margin-top: 3rem;
      text-align: center;
      font-size: 0.9rem;
      color: #666;
    }
  </style>
</head>
<body>
  <h1>üìú Scroll Registry of the Codex Ecclesia</h1>

  <div class="filters">
    <input type="text" id="searchInput" placeholder="üîç Search scrolls..." />
    <select id="tagFilter">
      <option value="">Filter by tag</option>
    </select>
    <select id="sectionFilter">
      <option value="">Filter by section</option>
    </select>
  </div>

  <div class="scroll-list" id="scrollList"></div>

  <footer>
    &copy; 2025 Borders Ecclesia Earth Trust ‚Ä¢ Sovereignty in Scroll and Spirit
  </footer>

  <script>
    const scrollList = document.getElementById('scrollList');
    const searchInput = document.getElementById('searchInput');
    const tagFilter = document.getElementById('tagFilter');
    const sectionFilter = document.getElementById('sectionFilter');
    let scrolls = [];

    async function loadScrolls() {
      try {
        const res = await fetch('scrolls.json'); // or 'manifest.json'
        scrolls = await res.json();
        populateFilters(scrolls);
        renderScrolls(scrolls);
      } catch (err) {
        scrollList.innerHTML = '<p>‚ö†Ô∏è Failed to load scrolls.</p>';
      }
    }

    function populateFilters(data) {
      const tags = new Set();
      const sections = new Set();
      data.forEach(s => {
        s.tags.forEach(tag => tags.add(tag));
        sections.add(s.section);
      });
      [...tags].sort().forEach(tag => {
        const opt = document.createElement('option');
        opt.value = tag;
        opt.textContent = tag;
        tagFilter.appendChild(opt);
      });
      [...sections].sort().forEach(section => {
        const opt = document.createElement('option');
        opt.value = section;
        opt.textContent = section;
        sectionFilter.appendChild(opt);
      });
    }

    function renderScrolls(data) {
      scrollList.innerHTML = '';
      if (data.length === 0) {
        scrollList.innerHTML = '<p>No scrolls match your filters.</p>';
        return;
      }
      data.forEach(scroll => {
        const card = document.createElement('div');
        card.className = 'scroll-card';
        card.innerHTML = `
          <h3>${scroll.title}</h3>
          <p><strong>Date:</strong> ${scroll.date}</p>
          <p>${scroll.summary}</p>
          <a href="${scroll.path}" target="_blank">Read Scroll ‚Üí</a>
        `;
        scrollList.appendChild(card);
      });
    }

    function applyFilters() {
      const query = searchInput.value.toLowerCase();
      const tag = tagFilter.value;
      const section = sectionFilter.value;
      const filtered = scrolls.filter(s => {
        const matchesQuery = s.title.toLowerCase().includes(query) || s.summary.toLowerCase().includes(query);
        const matchesTag = tag ? s.tags.includes(tag) : true;
        const matchesSection = section ? s.section === section : true;
        return matchesQuery && matchesTag && matchesSection;
      });
      renderScrolls(filtered);
    }

    searchInput.addEventListener('input', applyFilters);
    tagFilter.addEventListener('change', applyFilters);
    sectionFilter.addEventListener('change', applyFilters);

    loadScrolls();
  </script>
</body>
</html>
